<div class="container-fluid p-4">

  <div class="d-flex justify-content-between">
    <div class="d-flex gap-2">
      <button
        class="d-flex gap-2 btn btn-success"
        data-bs-toggle="modal"
        data-bs-target="#add-modal"
      >
        <i class="material-symbols-outlined"> person_add </i>
        Thêm mới
      </button>
    </div>
  </div>

  <!-- Table -->
  <div class="table-wrapper my-4">
    <div class="table-responsive border rounded">
      <div class="table-header bg-light rounded-top">
        <div class="d-flex justify-content-between align-items-center p-2">
          <input
            type="text"
            class="form-control"
            style="max-width: 260px"
            placeholder="Tìm kiếm..."
          />
        </div>
      </div>
      <table class="table table-responsive table-body">
        <thead>
          <tr>
            <th class="text-secondary">STT</th>
            <th class="text-secondary">Tên phim</th>
            <th class="text-secondary">Ngày khởi chiếu</th>
            <th class="text-secondary">Đạo diễn</th>
            <th class="text-secondary">Loại phim</th>
            <th class="text-secondary">Hãng sản xuất</th>
            <th class="text-secondary">Thời gian tạo</th>
            <th class="text-secondary">Thời gian cập nhật</th>
            <th class="text-secondary">Trạng thái</th>
            <th class="text-secondary">Hành động</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cinema of cinemas; index as index">
            <td>{{ index + 1 }}</td>
            <td class="text-truncate" style="max-width: 50px">
              {{ cinema.name }}
            </td>
            <td class="text-truncate" style="max-width: 50px">
              {{ cinema.releaseDate | date:'dd/MM/yyyy' }}
            </td>
            <td class="text-truncate" style="max-width: 50px">
              {{ cinema.director }}
            </td>
            <td class="text-truncate" style="max-width: 100px">
              {{ cinema.cinemaType }}
            </td>
            <td class="text-truncate" style="max-width: 100px">
              {{ cinema.producerName }}
            </td>
            <td>{{ cinema.createTime | date:'dd/MM/yyyy HH:mm:ss'}}</td>
            <td>{{ cinema.updateTime | date:'dd/MM/yyyy HH:mm:ss'}}</td>
            <td>
              <div
                class="d-inline-block bg-success bg-opacity-25 text-success p-2 rounded"
                [ngClass]="cinema.status === 1 ? 'text-success bg-success' : 'text-danger bg-danger'">
                {{ cinema.status === 1 ? "Đang chiếu" : "Dừng chiếu" }}
              </div>
            </td>
            <td>
              <a class="material-symbols-outlined" data-bs-toggle="modal" data-bs-target="#edit-modal">
                edit
              </a>
              <a class="material-symbols-outlined mx-2" data-bs-toggle="modal" data-bs-target="#deleteModal" (click)="openDeleteModal(cinema.id)">
                delete
              </a>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- <div class="table-footer rounded-bottom">
        <p-paginator
          [rows]="itemPerPage"
          [totalRecords]="totalItem"
          [pageLinkSize]="totalPage"
          (onPageChange)="onPageChange($event)"
        ></p-paginator>
      </div> -->
    </div>
  </div>

<!--   Add modal-->
  <div id="add-modal" class="modal fade" tabindex="-1" aria-labelledby="add-modal" aria-hidden="true" >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">Thêm mới phim</h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form #formAdd="ngForm" enctype="multipart/form-data">
            <div class="py-2">
              <label for="name">Tên phim</label>
              <input
                type="text"
                id="name"
                name="name"
                [(ngModel)]="cinema.name"
                #name="ngModel"
                class="form-control my-2"
                placeholder="Tên phim"
                required
              />
            </div>
            <div *ngIf="name.invalid && (name.dirty || name.touched)">
              <p class="text-danger" *ngIf="name.errors?.['required']">
                Vui lòng nhập tên phim
              </p>
            </div>
            <div class="py-2">
              <label for="releaseDate">Ngày khởi chiếu</label>
              <input
                type="date"
                id="releaseDate"
                name="releaseDate"
                [(ngModel)]="cinema.releaseDate"
                #release="ngModel"
                class="form-control my-2"
                placeholder="chọn ngày khởi chiếu"
                required
              />
            </div>
            <div *ngIf="release.invalid && (release.dirty || release.touched)">
              <p class="text-danger" *ngIf="release.errors?.['required']">
                Vui lòng chọn ngày khởi chiếu
              </p>
            </div>
            <div class="py-2">
              <label for="director">Đạo diễn</label>
              <input
                type="text"
                id="director"
                name="director"
                [(ngModel)]="cinema.director"
                #director = "ngModel"
                class="form-control my-2"
                placeholder="Đạo diễn"
                required
              />
            </div>
            <div *ngIf="director.invalid && (director.dirty || director.touched)">
              <p class="text-danger" *ngIf="director.errors?.['required']">
                Vui lòng nhập tên đạo diễn
              </p>
            </div>
            <div class="py-2">
              <label for="producerId">Hãng sản xuất</label>
              <select
                id="producerId"
                name="producerId"
                [(ngModel)]="cinema.producerId"
                #producer="ngModel"
                class="form-select my-2"
                required
              >
                <option [value]="0">Chọn hãng sản xuất</option>
                <option
                  *ngFor="let producer of producers"
                  [value]="producer.id"
                >
                  {{ producer.name }}
                </option>
              </select>
            </div>
            <div *ngIf="producer.invalid && (producer.dirty || producer.touched)">
              <p class="text-danger" *ngIf="producer.errors?.['required']">
                Vui lòng chọn hãng sản xuất
              </p>
            </div>
            <div class="py-2">
              <label for="cinemaTypeId">Loại phim</label>
              <select
                id="cinemaTypeId"
                name="cinemaTypeId"
                [(ngModel)]="cinema.cinemaTypeId"
                #type="ngModel"
                class="form-select my-2"
                required
              >
                <option [value]="0">Chọn loại phim</option>
                <option *ngFor="let type of cinemaTypes" [value]="type.id">
                  {{ type.name }}
                </option>
              </select>
            </div>
            <div *ngIf="type.invalid && (type.dirty || type.touched)">
              <p class="text-danger" *ngIf="type.errors?.['required']">
                Vui lòng chọn loại phim
              </p>
            </div>
            <div class="py-2">
              <label for="image">Hình ảnh</label>
              <input
                type="file"
                id="image"
                name="image"
                class="form-control"
              />
            </div>
<!--            <div class="py-2 form-switch">-->
<!--              <input class="form-check-input" type="checkbox"-->
<!--                     name="status"-->
<!--                     id="status"-->
<!--                     [(ngModel)]="cinema.status">-->
<!--              <label class="form-check-label" for="status">Trạng thái</label>-->
<!--            </div>-->
            <div class="py-2">
              <label for="status">Trạng thái</label>
              <select
                id="status"
                name="status"
                [(ngModel)]="cinema.status"
                #type="ngModel"
                class="form-select my-2"
                required
              >
                <option [value]="0">Dừng chiếu</option>
                <option [value]="1">
                  Đang chiếu
                </option>
              </select>
            </div>
            <div class="d-flex justify-content-end gap-2">
              <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
                Hủy
              </button>
              <button
                [disabled]="formAdd.invalid"
                type="submit"
                class="btn btn-primary"
                data-bs-dismiss="modal"
                (click)="onSubmit(formAdd.value, formAdd)">
                Thêm Mới
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure to delete this item?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="onDelete()">Confirm</button>
        </div>
      </div>
    </div>
  </div>
</div>
